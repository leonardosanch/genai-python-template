#!/bin/bash
# Pre-commit hook for Claude Agent
# This script runs basic checks before allowing a task to be marked complete.

echo "ğŸ›¡ï¸ Running Safety Checks..."

# 1. Check for hardcoded secrets (Basic grep)
echo "ğŸ” Checking for secrets..."
if grep -rE "password\s*=\s*['\"][^'\"]+['\"]" src/; then
    echo "âŒ POTENTIAL SECRET FOUND! Please use environment variables."
    exit 1
fi

# 2. Run Ruff Linting
echo "ğŸ§¹ Running Linter..."
uv run ruff check src/
if [ $? -ne 0 ]; then
    echo "âŒ Linting failed. Please fix errors before proceeding."
    exit 1
fi

# 3. Run Type Checking
echo "ğŸ” Checking types..."
uv run mypy src/
if [ $? -ne 0 ]; then
    echo "âŒ Type check failed. Please fix type errors."
    exit 1
fi

echo "âœ… All checks passed! You are safe to proceed."
exit 0
